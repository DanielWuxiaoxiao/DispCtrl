# DispCtrl 配置文件说明文档

## 文件概述
- **文件名**: `config.json`
- **版本**: 1.0
- **用途**: 雷达显示控制系统的网络通信和显示参数配置
- **格式**: 标准JSON格式，不支持注释
- **编码**: UTF-8

## 配置结构说明

### 1. 网络配置 (network)

#### 1.1 IP地址配置 (ips)
各子系统的网络地址配置，用于建立系统间的TCP/UDP通信连接。

| 配置项 | IP地址 | 说明 |
|--------|--------|------|
| `DISP_CTRL_IP` | 192.168.64.4 | **显示控制系统IP地址** - 本系统的网络地址 |
| `DATA_PRO_IP` | 192.168.64.3 | **数据处理系统IP地址** - 负责雷达数据处理和航迹生成 |
| `SIG_PRO_IP` | 192.168.64.3 | **信号处理系统IP地址** - 负责雷达信号处理和检测点生成 |
| `RES_DIS_IP` | 192.168.64.3 | **资源调度系统IP地址** - 负责系统资源分配和任务调度 |
| `PHOTO_ELE_IP` | 192.168.101.10 | **光电设备系统IP地址** - 光电跟踪设备控制系统 |
| `MONITOR_IP` | 192.168.64.3 | **监控系统IP地址** - 系统状态监控和告警管理 |
| `DISP_CTRL_IP_FOR_PHOTO` | 192.168.101.14 | **显示控制对光电设备的IP** - 用于与光电设备通信的专用地址 |

#### 1.2 系统ID配置 (ids)
各子系统的唯一标识符，用于消息路由和系统识别。

| 配置项 | ID值 | 说明 |
|--------|------|------|
| `RES_DIS_ID` | 47873 | **资源调度系统ID** - 任务分配和资源管理 |
| `SIG_PRO_ID` | 47874 | **信号处理系统ID** - 雷达信号处理和目标检测 |
| `DATA_PRO_ID` | 47875 | **数据处理系统ID** - 航迹关联和目标跟踪 |
| `DISP_CTRL_ID` | 47876 | **显示控制系统ID** - 本系统标识符 |
| `TAR_CLA_ID` | 47877 | **目标分类系统ID** - 目标识别和分类处理 |
| `MONITOR_ID` | 47878 | **监控系统ID** - 系统状态监控和健康管理 |

#### 1.3 通信端口配置 (ports)
各子系统间的双向通信端口配置。端口号规律：
- 6xxx系列：发送端口 (Send Ports)  
- 8xxx系列：接收端口 (Receive Ports)
- 1xxxx系列：光电设备专用端口

##### 显示控制 ↔ 资源调度通信
| 配置项 | 端口号 | 通信方向 | 数据类型 |
|--------|--------|----------|----------|
| `DISP_2_RES_PORT` | 6012 | 显示控制 → 资源调度 | 任务请求、资源申请 |
| `RES_GET_DISP_PORT` | 8012 | 资源调度 ← 显示控制 | 任务分配结果、资源状态 |

##### 显示控制 ↔ 信号处理通信
| 配置项 | 端口号 | 通信方向 | 数据类型 |
|--------|--------|----------|----------|
| `DISP_2_SIG_PORT` | 6002 | 显示控制 → 信号处理 | 控制指令、参数设置 |
| `SIG_GET_DISP_PORT` | 8002 | 信号处理 ← 显示控制 | 指令响应、状态反馈 |
| `SIG_2_DISP_PORT1` | 6003 | 信号处理 → 显示控制 | **检测点数据流** |
| `SIG_2_DISP_PORT2` | 6004 | 信号处理 → 显示控制 | **系统状态信息** |
| `DISP_GET_SIG_PORT1` | 8003 | 显示控制 ← 信号处理 | 接收检测点数据 |
| `DISP_GET_SIG_PORT2` | 8004 | 显示控制 ← 信号处理 | 接收状态信息 |

##### 显示控制 ↔ 数据处理通信
| 配置项 | 端口号 | 通信方向 | 数据类型 |
|--------|--------|----------|----------|
| `DATA_PRO_2_DISP` | 6006 | 数据处理 → 显示控制 | **航迹数据** (主要数据流) |
| `DISP_GET_DATA_PORT` | 8006 | 显示控制 ← 数据处理 | 接收航迹数据 |
| `DISP_2_DATA` | 6008 | 显示控制 → 数据处理 | **控制指令** |
| `DATA_GET_DISP` | 8008 | 数据处理 ← 显示控制 | 接收控制指令 |
| `DATA_PRO_2_DISP2` | 6010 | 数据处理 → 显示控制 | **扩展数据通道** |
| `DISP_GET_DATA_PORT2` | 8010 | 显示控制 ← 数据处理 | 接收扩展数据 |

##### 显示控制 ↔ 目标分析通信
| 配置项 | 端口号 | 通信方向 | 数据类型 |
|--------|--------|----------|----------|
| `TARGET_2_DISP` | 6017 | 目标分析 → 显示控制 | **目标分析结果** |
| `DISP_GET_TARGET_PORT` | 8017 | 显示控制 ← 目标分析 | 接收分析结果 |

##### 显示控制 ↔ 监控系统通信
| 配置项 | 端口号 | 通信方向 | 数据类型 |
|--------|--------|----------|----------|
| `DISP_2_MONITOR` | 6018 | 显示控制 → 监控系统 | **系统状态上报** |
| `MONITOR_GET_DISP_PORT` | 8018 | 监控系统 ← 显示控制 | 接收状态信息 |
| `MONITOR_2_DISP` | 6019 | 监控系统 → 显示控制 | **监控指令下发** |
| `DISP_GET_MONITOR_PORT` | 8019 | 显示控制 ← 监控系统 | 接收监控指令 |

##### 显示控制 ↔ 光电设备通信
| 配置项 | 端口号 | 通信方向 | 数据类型 |
|--------|--------|----------|----------|
| `DISP_2_PHOTO_PORT` | 10100 | 显示控制 → 光电设备 | **光电设备控制参数** |
| `PHOTO_GET_DISP_PORT` | 21001 | 光电设备 ← 显示控制 | 接收控制参数 |

### 2. 极坐标显示配置 (polarDisp)

#### 2.1 距离范围配置 (range)
PPI (Plan Position Indicator) 极坐标显示器的距离显示范围设置。

| 配置项 | 数值 | 单位 | 说明 |
|--------|------|------|------|
| `max` | 5000 | 米 | **最大显示距离** - PPI显示器能够显示的最远探测距离 |
| `min` | 0 | 米 | **最小显示距离** - PPI显示器的最近显示距离 |

## 网络拓扑结构

```
雷达显示控制系统网络拓扑
==============================

网段1: 192.168.64.x (主要系统网段)
├── 192.168.64.3 (数据处理/信号处理/资源调度/监控)
│   ├── 数据处理系统 (DATA_PRO)    - 航迹数据生成
│   ├── 信号处理系统 (SIG_PRO)     - 检测点数据生成  
│   ├── 资源调度系统 (RES_DIS)     - 任务分配管理
│   └── 监控系统 (MONITOR)         - 系统状态监控
│
└── 192.168.64.4 (显示控制系统)
    └── 显示控制系统 (DISP_CTRL)   - 本系统

网段2: 192.168.101.x (光电设备网段)  
├── 192.168.101.10 (光电设备)
│   └── 光电设备系统 (PHOTO_ELE)   - 光电跟踪设备
│
└── 192.168.101.14 (显示控制对光电接口)
    └── 显示控制系统光电接口        - 专用光电通信接口
```

## 数据流向图

```
数据流向关系图
=============

检测点数据流:
信号处理系统 --6003--> 显示控制系统 (检测点实时数据)
信号处理系统 --6004--> 显示控制系统 (系统状态信息)

航迹数据流:  
数据处理系统 --6006--> 显示控制系统 (航迹数据)
数据处理系统 --6010--> 显示控制系统 (扩展数据)

目标分析流:
目标分析系统 --6017--> 显示控制系统 (分析结果)

控制指令流:
显示控制系统 --6002--> 信号处理系统 (信号处理控制)
显示控制系统 --6008--> 数据处理系统 (数据处理控制) 
显示控制系统 --6012--> 资源调度系统 (资源申请)

监控管理流:
显示控制系统 --6018--> 监控系统 (状态上报)
监控系统     --6019--> 显示控制系统 (监控指令)

光电控制流:
显示控制系统 --10100--> 光电设备系统 (光电控制)
```

## 配置修改注意事项

### 安全提醒
1. **网络地址修改**: 修改IP地址前必须确保网络连通性
2. **端口冲突检查**: 确保端口号不与系统其他服务冲突  
3. **ID唯一性**: 系统ID必须在整个网络中唯一
4. **备份配置**: 修改前请备份原始配置文件

### 修改步骤
1. 停止所有相关服务
2. 备份当前配置文件
3. 修改配置参数
4. 验证配置格式正确性
5. 重启服务并验证连通性

### 常见问题
- **JSON格式错误**: 确保逗号、引号、括号正确匹配
- **端口被占用**: 使用 `netstat -an` 检查端口状态
- **网络不通**: 使用 `ping` 命令验证网络连接
- **防火墙阻拦**: 检查防火墙设置，开放必要端口

## 配置验证工具

可以使用以下命令验证配置文件格式：
```bash
# 验证JSON格式
python -m json.tool config.json

# 验证网络连通性
ping 192.168.64.3
ping 192.168.101.10

# 检查端口占用
netstat -an | grep :6002
```

---
**最后更新**: 2024年
**维护人员**: DispCtrl开发团队